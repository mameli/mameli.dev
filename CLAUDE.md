# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a personal blog and website built with Astro 5, deployed on Vercel. The site features:
- Static site generation with content collections for blog posts
- MDX support for rich content authoring
- Automatic light/dark theme switching via CSS
- Progressive Web App (PWA) support
- Vercel Analytics integration
- RSS feed generation

## Development Commands

All commands use the package manager of choice (npm, bun, etc.):

```bash
bun dev          # Start dev server at localhost:4321
bun build        # Build production site to ./dist/
bun preview      # Preview production build locally
bun astro ...    # Run Astro CLI commands (add, check, etc.)
```

## Architecture

### Content Management

Blog posts are managed via Astro's Content Collections API:
- **Location**: `src/content/blog/` - All blog posts as `.md` or `.mdx` files
- **Schema**: Defined in `src/content.config.ts` with required fields: `title`, `description`, `pubDate`, `author` (defaults to "Mameli"), and optional `heroImage`
- **Loader**: Uses glob loader to automatically discover and load blog posts
- **Rendering**: Posts are rendered through `src/pages/blog/[...slug].astro` which uses `getStaticPaths()` to generate static pages at build time

### Key Configuration Files

- **`src/consts.ts`**: Global constants including `SITE`, `SITE_TITLE`, and `SITE_DESCRIPTION` - update these for site-wide changes
- **`astro.config.mjs`**: Main Astro configuration with integrations (MDX, sitemap, PWA, Vercel adapter) and markdown syntax highlighting themes (one-dark-pro for dark, solarized-light for light)
- **`vercel.json`**: Vercel-specific configuration for headers, caching, and routing
- **`tailwind.config.js`**: TailwindCSS configuration with custom typography plugin settings for code blocks in light/dark themes

### Component Structure

- **`src/layouts/Layout.astro`**: Base page layout wrapper
- **`src/layouts/BlogPost.astro`**: Blog post layout that includes header, metadata, content slot, and footer with Buy Me a Coffee integration
- **`src/components/BaseHead.astro`**: SEO meta tags, OpenGraph, Twitter cards, PWA manifest, canonical URLs, and font preloading
- **`src/components/FormattedDate.astro`**: Date formatting utility component

### Routing & Pages

- **`src/pages/index.astro`**: Homepage
- **`src/pages/blog/index.astro`**: Blog listing page
- **`src/pages/blog/[...slug].astro`**: Dynamic blog post pages generated from content collection
- **`src/pages/connect.astro`**: Contact/social links page
- **`src/pages/rss.xml.js`**: RSS feed generation using `@astrojs/rss`

### Styling

- Uses TailwindCSS 4 with Vite plugin
- Global styles in `src/styles/global.css`
- Dark mode via `prose-invert` utility classes
- Custom code block styling configured in tailwind.config.js (removes backtick decorators, sets custom colors)
- Typography plugin for prose styling with extensive customization

### TypeScript Configuration

- Extends `astro/tsconfigs/strict` with `strictNullChecks: true`
- All type definitions must be precise with explicit null/undefined handling
- Type definitions in `src/types.d.ts`

## Important Implementation Notes

### Adding Blog Posts

1. Create a new `.md` or `.mdx` file in `src/content/blog/`
2. Include required frontmatter: `title`, `description`, `pubDate`, optionally `author` and `heroImage`
3. The file name becomes the URL slug (e.g., `my-post.md` â†’ `/blog/my-post/`)
4. Build will automatically generate the static page

### Syntax Highlighting

Configured in `astro.config.mjs` to use:
- Dark theme: `one-dark-pro`
- Light theme: `solarized-light`

### PWA Configuration

- Manifest and service worker are auto-generated by `@vite-pwa/astro`
- Icons defined in `astro.config.mjs` (180x180, 192x192, 512x512)
- Workbox caches CSS, JS, HTML, SVG, PNG, ICO, and TXT files
- PWA enabled in development mode for testing

### Deployment

- Vercel adapter configured with static output mode
- Security headers set in `vercel.json` (X-Content-Type-Options, X-Frame-Options, X-XSS-Protection)
- Asset caching configured (immutable for `/assets/*`, no-cache for HTML and service worker)

## Code Style

- Strict TypeScript enforcement as per tsconfig.json
- Follow existing formatting conventions (no explicit formatter configured)
- Component naming: PascalCase for Astro components
- Keep styling inline with TailwindCSS utility classes
